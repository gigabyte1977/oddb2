var settings={szgrtype:5,wminoncontent:false,newtabswitch:false,winlinknew:false,winlink2tab:false,closeontransfer:true,effects:200};var geb={0:0,"-1":16,"-2":32,"-3":48,"-4":64,1000:80,1001:96,1002:112,1003:128,1004:144,1005:160,1006:176,1007:192,1008:208,1009:224,1010:240,1011:256,1012:272,1013:288,1014:304,1015:320,1016:336,1017:352,1018:368,1019:384,1020:400,1021:416,1022:432,1023:448,1024:464,1025:480,1026:496,1027:512,1028:528,1029:544,1030:560,1031:576,1032:592,1033:608,1034:624,1035:640,1036:656,1037:672,1038:688,1039:704,1040:720,1041:736,1042:752,1043:992,1044:784,1045:800,1046:816,1047:832,1048:848,1049:864,1050:880,1051:944,1052:896,1053:912,1054:928,1055:976,1056:960,1057:768};var touchSupport=("ontouchstart" in window);function url(b){document.location.href=b}var historyapi=!!(window.history&&window.history.pushState);$(document).ready(function(){sm_updatesize();var b=$(document);b.bind("click",function(d){cm_close();if(startmenu&&(d.button!=2||$(d.target).parents("#startmenuc").attr("id")==null)){sm_hide()}}).bind("mousemove touchmove",function(f){if(fmove){if(f.type=="touchmove"&&f.originalEvent.targetTouches){var d=fmoveobj[0]+f.originalEvent.targetTouches[0].pageX-fmovepos[0];var g=fmoveobj[1]+f.originalEvent.targetTouches[0].pageY-fmovepos[1]}else{var d=fmoveobj[0]+f.pageX-document.documentElement.scrollLeft-fmovepos[0];var g=fmoveobj[1]+f.pageY-document.documentElement.scrollTop-fmovepos[1]}if(g>$(window).height()-90){g=$(window).height()-90}else{if(g<0){g=0}}if(d>$(window).width()-40){d=$(window).width()-40}else{if(d<-1*$("#fenster"+fmove).width()+40){d=-1*$("#fenster"+fmove).width()+40}}$("#fenster"+fmove).css({left:d+"px",top:g+"px"})}if(tooltip){tt_pos(f)}}).bind("mouseup touchend",function(d){fmove=0;if(d.type=="touchend"&&!contextmenuTriggered&&!$(d.target).parents("#contextmenu").length){cm_close()}});$(window).resize(function(){wbar_update();sm_updatesize();$(".fenster").css({maxHeight:($(window).height()-95)+"px"});$(".fenster .fcc").css({maxHeight:($(window).height()-145)+"px"});jQuery.each(fenster,function(){var d=$("#fenster"+this[0]).offset();d.top-=$(window).scrollTop();d.left-=$(window).scrollLeft();if(d.top>$(window).height()-115){$("#fenster"+this[0]).css("top",($(window).height()-115)+"px")}if(d.left>$(window).width()-50){$("#fenster"+this[0]).css("left",($(window).width()-50)+"px")}if(d.top<0){$("#fenster"+this[0]).css("top","0px")}})});$("#logo").click(function(f){if(f.which==3){return true}var d=1;if(f.which==2||f.ctrlKey){d=2}page_load(d,"Übersicht","index.php?p=oview",false,false)}).mouseup(function(d){if(d.which==2){page_load(2,"Übersicht","index.php?p=oview",false,false)}}).bind("contextmenu touchcontextmenu",function(d){cm_open(d,1,"index.php?p=oview");return false});$("#menu > a").click(function(f){if(f.which==2||f.which==3){return true}var d=1;if(f.ctrlKey){d=2}if(contextmenuTriggered){f.preventDefault();return false}page_load(d,false,$(this).data("link"),false,false)}).mousedown(function(d){if(d.which==2){page_load(2,false,$(this).data("link"),false,false);return false}}).bind("contextmenu touchcontextmenu",function(d){if(typeof($(this).data("link"))=="undefined"){return false}cm_open(d,1,$(this).data("link"));return false});b.on("click",".link",function(f){if(f.which==3){return true}if(contextmenuTriggered){f.preventDefault();return false}if(typeof($(this).data("link"))=="undefined"||$(this).data("link")==""){if($(this).attr("link")!=null&&$(this).attr("link")!=""){$(this).data("link",$(this).attr("link"))}else{return false}}if($(this).parents(".fenster").attr("id")!=null){var g=$(this).parents(".fenster").attr("id");var d=4;if(f.which==2||f.ctrlKey||(settings.winlinknew&&$(this).hasClass("winlink"))){d=5}g=g.replace(/[^\d]/g,"");page_load(d,false,$(this).data("link"),g,false)}else{if($(this).hasClass("winlink")){var d=5;if(settings.winlink2tab){var d=1;if(f.which==2||f.ctrlKey||settings.winlinknew){d=2}}page_load(d,false,$(this).data("link"),false,false)}else{var d=1;if(f.which==2||f.ctrlKey){d=2}page_load(d,false,$(this).data("link"),acttab,false)}}}).on("mouseup",".link",function(d){if(d.which==2){var f=$(this).parents(".fenster").attr("id");if(f!=null){page_load(5,false,$(this).data("link"),false,false)}else{page_load(2,false,$(this).data("link"),false,false)}}});b.on("click",".cswlink",function(f){if(f.which==3){return true}if(contextmenuTriggered){f.preventDefault();return false}if(f.which==2||f.ctrlKey){page_load(2,false,$(this).data("link"),false,false)}else{var d=false;if($(this).data("reload")){d=true}contentswitch(this,$(this).data("pos"),d)}}).on("mouseup",".cswlink",function(d){if(d.which==2){page_load(2,false,$(this).data("link"),false,false)}});b.on("contextmenu touchcontextmenu",".contextmenu, .cswlink",function(d){if(typeof($(this).data("link"))=="undefined"){if($(this).attr("link")!=null){$(this).data("link",$(this).attr("link"))}else{return false}}var f=$(this).data("link");cm_open(d,1,f);return false});b.on("mouseover touchmousedown",".tooltip",function(k){if($(this).hasClass("plscreen")&&typeof($(this).data("tooltip"))=="undefined"){var j=$(this).data("plscreen").split("_");var d=j[1].split("+");var f=j[2].split("+");for(var g=1;g<=36;g++){if(typeof(d[g])=="undefined"){d[g]=0}}for(var g=1;g<=12;g++){if(typeof(f[g])=="undefined"){f[g]=0}}var h='<div class="plscreentt"><table cellpadding="0" cellspacing="0" class="sysshoworgebt2"><tr><td style="background-position:-'+geb[f[7]]+'px 0px"></td><td style="background-position:-'+geb[f[1]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[f[8]]+'px 0px"></td><td style="background-position:-'+geb[f[2]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[f[9]]+'px 0px"></td><td style="background-position:-'+geb[f[3]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[f[10]]+'px 0px"></td><td style="background-position:-'+geb[f[4]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[f[11]]+'px 0px"></td><td style="background-position:-'+geb[f[5]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[f[12]]+'px 0px"></td><td style="background-position:-'+geb[f[6]]+'px 0px"></td></tr></table><table cellpadding="0" cellspacing="0" class="sysshowplgebt" style="background-image:url(img/planeten/'+j[0]+'.jpg)"><tr><td style="background-position:-'+geb[d[36]]+'px 0px"></td><td style="background-position:-'+geb[d[35]]+'px 0px"></td><td style="background-position:-'+geb[d[29]]+'px 0px"></td><td style="background-position:-'+geb[d[23]]+'px 0px"></td><td style="background-position:-'+geb[d[30]]+'px 0px"></td><td style="background-position:-'+geb[d[34]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[d[32]]+'px 0px"></td><td style="background-position:-'+geb[d[24]]+'px 0px"></td><td style="background-position:-'+geb[d[18]]+'px 0px"></td><td style="background-position:-'+geb[d[10]]+'px 0px"></td><td style="background-position:-'+geb[d[19]]+'px 0px"></td><td style="background-position:-'+geb[d[25]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[d[28]]+'px 0px"></td><td style="background-position:-'+geb[d[14]]+'px 0px"></td><td style="background-position:-'+geb[d[6]]+'px 0px"></td><td style="background-position:-'+geb[d[2]]+'px 0px"></td><td style="background-position:-'+geb[d[7]]+'px 0px"></td><td style="background-position:-'+geb[d[15]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[d[22]]+'px 0px"></td><td style="background-position:-'+geb[d[13]]+'px 0px"></td><td style="background-position:-'+geb[d[5]]+'px 0px"></td><td style="background-position:-'+geb[d[1]]+'px 0px"></td><td style="background-position:-'+geb[d[3]]+'px 0px"></td><td style="background-position:-'+geb[d[11]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[d[31]]+'px 0px"></td><td style="background-position:-'+geb[d[17]]+'px 0px"></td><td style="background-position:-'+geb[d[9]]+'px 0px"></td><td style="background-position:-'+geb[d[4]]+'px 0px"></td><td style="background-position:-'+geb[d[8]]+'px 0px"></td><td style="background-position:-'+geb[d[16]]+'px 0px"></td></tr><tr><td style="background-position:-'+geb[d[33]]+'px 0px"></td><td style="background-position:-'+geb[d[27]]+'px 0px"></td><td style="background-position:-'+geb[d[21]]+'px 0px"></td><td style="background-position:-'+geb[d[12]]+'px 0px"></td><td style="background-position:-'+geb[d[20]]+'px 0px"></td><td style="background-position:-'+geb[d[26]]+'px 0px"></td></tr></table><br />'+j[3]+"</div>";$(this).data("tooltip",h)}if(typeof($(this).data("tooltip"))=="undefined"){return false}$("#tooltip").html($(this).data("tooltip"));tt_pos(k);$("#tooltip").stop(true,true).fadeIn(250);tooltip=true}).on("mouseout",".tooltip",function(){$("#tooltip").stop(true,true).fadeOut(250);tooltip=false});b.on("touchstart",function(d){if(!$(d.target).hasClass("tooltip")){$("#tooltip").stop(true,true).hide();tooltip=false}});$("#tabbar").on("click",".tab",function(d){if(d.button!=0){return true}tab_click($(this).attr("id"))}).on("contextmenu touchcontextmenu",".tab, .tabactive",function(d){cm_open(d,2,$(this).attr("id"));return false}).on("click",".tabclose",function(d){if(d.button!=0){return true}tab_close($(this).attr("id"));return false});$("#windowbar").on("click",".barwindow, .barwindowact",function(d){if(d.button!=0){return true}wbar_click($(this),0)}).on("contextmenu touchcontextmenu",".barwindow, .barwindowact",function(d){var g=$(this).attr("id");g=g.replace(/[^\d]/g,"");var f=$("#fenster"+g).data("link");cm_open(d,3,[f,g]);return false}).on("click","#startbutton",function(){sm_show()}).on("contextmenu","#startbutton",function(){sm_show();return false});b.on("mousedown touchstart",".fenster",function(){wbar_click($(this),1)}).on("mousedown touchstart",".fhl1",function(d){if(d.type=="touchstart"){if($(d.target).parents(".hl1buttons").length){return}d.preventDefault()}var f=$(this).parent().attr("id");f=f.replace(/fenster/g,"");fmove=f;if(d.type=="touchstart"&&d.originalEvent.targetTouches){fmovepos=[d.originalEvent.targetTouches[0].pageX,d.originalEvent.targetTouches[0].pageY]}else{fmovepos=[d.pageX-document.documentElement.scrollLeft,d.pageY-document.documentElement.scrollTop]}fmoveobj=[parseInt($(this).parent().css("left").replace(/px/g,"")),parseInt($(this).parent().css("top").replace(/px/g,""))]});$("#startmenuc").on("click",".fav",function(d){if(d.which==3){return true}var f=$(this).data("link");if(f==null||f==""){return false}if(typeof($(this).data("type"))=="undefined"){type=1}else{type=$(this).data("type")}if(type==1){if(d.which==2||d.ctrlKey){type=2}}page_load(type,false,f,acttab,false)}).on("mouseup",".fav",function(f){if(f.which==2){var g=$(this).data("link");if(g==null||g==""){return false}var d=$(this).data("type");if(d==null){d=1}if(d==1){d=2}page_load(d,false,g,acttab,false)}}).on("contextmenu touchcontextmenu","#favoriten a, #historyc a",function(d){if(typeof($(this).data("link"))=="undefined"){return false}cm_open(d,1,$(this).data("link"));return false});b.on("keypress",function(d){if(d.altKey&&d.ctrlKey&&d.which==116){tab_next()}}).on("keypress",".enter",function(h){if(h.keyCode==13){var d=(typeof($(h.target).data("action"))=="undefined")?$(h.target).attr("rel"):$(h.target).data("action");var g=$(h.target).parents("form");if(d){d=addajax(d);g.attr("action",d)}g.trigger("onsubmit")}});$.ajaxSetup({dataType:"xml"});b.ajaxStart(function(){$("#ajax").show()}).ajaxComplete(function(){$("#ajax").hide()});b.on("click",".togglecheckbox",function(){var e=$(this).data("name");if(e==null){return false}var d=$(this).parents("form").find('input[name="'+e+'"], .'+e);if(d==null){return false}if(d.attr("disabled")){return false}d.prop("checked",!d.prop("checked"))});b.on("click",".allyfilter input, .allyfilter a",function(){var f=this.parentNode.parentNode;var e=$(f).siblings(".allyfiltert");var g=this.name;if(this.tagName=="A"){if($(this).css("opacity")<1||$(f).find("input[name!="+g+"]:checked").length>0){$(f).find("input").prop("checked",false);$(f).find("input[name="+g+"]").prop("checked",true);$(f).find("a[name!="+g+"]").css("opacity",0.5);$(f).find("a[name="+g+"]").css("opacity",1);$(e).find("tr").not(":first-child").each(function(){if($(this).data("ally")==g){$(this).removeClass("hidden")}else{$(this).addClass("hidden")}})}else{$(f).find("input").prop("checked",true);$(f).find("a").css("opacity",1);$(e).find("tr").removeClass("hidden")}}else{var d=this.checked;$(e).find("tr[data-ally="+g+"]").each(function(){if(d){$(this).removeClass("hidden")}else{$(this).addClass("hidden")}});if(d){$(f).find("a[name="+g+"]").css("opacity",1)}else{$(f).find("a[name="+g+"]").css("opacity",0.5)}}});b.on("mouseenter",".routemarker",function(){$(".routemarker").html("");$(this).html('<img src="img/layout/leer.gif" class="hoverbutton" style="background-position:-1060px -91px" title="Marker setzen" onclick="route_marker(this)" />')}).on("mouseleave",".routemarker",function(){$(this).html("")}).on("touchmousedown",".routemarker",function(){$(this).html("<span />");route_marker($(this).children()[0])});b.on("click",".searchpltyplist > img",function(){$(this).toggleClass("active");var e=$(this).parents("form"),g=e.find(".searchpltyp");g.html("");var d=[];$(this.parentNode).children(".active").each(function(){var f=$(this).attr("src");d.push(f.replace(/[^\d]/g,""));g.append('<img src="'+f+'" alt="" />')});d=d.join("-");e.find("input[name=t]").val(d);if(d==""){g.html("<i>alle</i>")}});b.on("click",".searchgeblist > img",function(){$(this).toggleClass("active");var e=$(this).parents("form");var g=e.find(".searchgeb");g.html("");var d=[];$(this.parentNode).children(".active").each(function(){d.push($(this).data("id"));g.append('<img src="'+$(this).attr("src")+'" alt="" />')});d=d.join("-");e.find("input[name=geb]").val(d);if(d==""){g.html("<i>alle</i>")}});b.on("dblclick",".kommentar.searchicon",function(){if(window.confirm("Soll der Kommentar wirklich gelöscht werden?")){var d=this.className.match(/plkommentar(\d+) /);if(d){ajaxcall("index.php?p=show_planet&sp=kommentar&ajax&id="+d[1],false,{kommentar:""},false)}}});b.on("click",".icon_forschung_filter",function(){$(this).toggleClass("icon_forschung_filter_active");forschungPage.filter(this)});b.on("click",".openinod-link",function(d){var f=$(this.parentNode).siblings("table").find("a[data-sys]");if(f.length&&window.confirm("Diese Operation öffnet "+f.length+" neue Tabs/Fenster auf einmal. Fortfahren?")){f.each(function(){window.open(ODServer+"/game/index.php?op=system&sys="+$(this).data("sys"))})}d.preventDefault();return false});if($("#content1").attr("id")!=null&&document.location.href.indexOf("#p=")!=-1){var c="index.php?"+document.location.href.replace(/^(.*)\#(.*)$/,"$2");if($("#content1").data("link")!=c){var a=false;$("#content1 .cswlink").each(function(){if($(this).data("link")==c){contentswitch(this,$(this).data("pos"),false);a=true;$("head").append('<link rel="shortcut icon" href="favicon.ico" />')}});if(!a){page_load(1,false,c,acttab,false);$("head").append('<link rel="shortcut icon" href="favicon.ico" />')}}}else{dbhistory_add($("#content1").data("link"),tabs[0][1],1)}if(historyapi){$(window).bind("popstate",function(){history_checkapi(location.href)})}else{window.setInterval(history_check,2000)}});function addajax(a){if(a.indexOf("&ajax")==-1&&a.indexOf("?ajax")==-1){if(a.indexOf("?")!=-1){a+="&ajax"}else{a+="?ajax"}}return a}function ajaxcall(addr,r,post,errorout){if(post==false){var ajaxtype="get";post=""}else{var ajaxtype="post"}addr=addajax(addr);$.ajax({type:ajaxtype,url:addr,data:post,success:function(data,status,xhr){if(xhr.responseText.substr(0,5)!="<?xml"){var error=xhr.responseText;error=error.replace(/\r\n/g,"");error=error.replace(/\n/g,"");error=error.replace(/<\?xml(.*)$/,"");error="Es ist ein Fehler aufgetreten:<br />Adresse: "+addr+"<br />"+error}else{var error=$(data).find("error").text()}if(error){if(errorout&&r){$(r).html('<div class="error">'+error+"</div>")}else{if(error.indexOf("mehr eingeloggt")!=-1){alert("Du bist nicht mehr eingeloggt!")}else{alert(error)}}}else{var content=$(data).find("content").text();if(r){$(r).html(content)}var script=$(data).find("script").text();if(script!=""){eval(script)}}},error:function(e,msg){if(e.status!=0){var content=e.responseText.replace(/<\?xml([.\s]*)$/,"");if(errorout&&r){$(r).html("Es ist ein Fehler aufgetreten!<br /><br />Fehlermeldung: "+msg+" "+e.status+"<br /><br />Adresse: "+addr+"<br /><br />"+content)}else{content=content.replace(/<br \/>/g,"\n");content=content.replace(/<(|\/)b>/g,"");alert("Es ist ein Fehler aufgetreten!\n\nFehlermeldung: "+msg+" "+e.status+"\n\nAdresse: "+addr+"\n\n"+content)}}}})}function page_load(type,name,addr,el,post){var ajaxtype="GET";if(post){ajaxtype="POST"}else{post=""}if(type==3){if(addr.indexOf("&ajax")!=-1){addr=addr.replace(/&ajax/g,"")}if(addr.indexOf("?ajax")!=-1){addr=addr.replace(/\?ajax/g,"")}window.open(addr)}else{addr=addajax(addr);if(type==1||type==2){if(type==1){var tab=acttab;if(el){tab=el}$("#content"+tab).data("link",addr.replace(/(&ajax)|(&switch)/g,""));tab_update()}else{if(type==2){var tab=tab_create(name,false,addr)}}if(settings.wminoncontent){win_minall()}$.ajax({type:ajaxtype,url:addr,data:post,success:function(data,status,xhr){if(xhr.responseText.substr(0,5)!="<?xml"){var error=xhr.responseText;error=error.replace(/\r\n/g,"");error=error.replace(/\n/g,"");error=error.replace(/<\?xml(.*)$/,"");error="Es ist ein Fehler aufgetreten:<br />Adresse: "+addr+"<br />"+error}else{var error=$(data).find("error").text()}if(error){$("#content"+tab).html(tab_headline("Fehler!",false)+page_error(error)).data("link","");tab_rename(tab,"Fehler!");tab_update()}else{var name=$(data).find("name").text();tab_rename(tab,name);$("#content"+tab).html(tab_headline(name,addr)+$(data).find("content").text());if(type==1||settings.newtabswitch){$("html, body").scrollTop(0)}tab_update();dbhistory_add(addr,name,type);var script=$(data).find("script").text();if(script){eval(script)}}},error:function(e,msg){if(e.status!=0){var content=e.responseText.replace(/<\?xml([.\s]*)$/,"");$("#content"+tab).html(tab_headline("Fehler!",false)+page_error("Es ist ein Fehler aufgetreten!<br /><br />Fehlermeldung: "+msg+" "+e.status+"<br /><br />Adresse: "+addr+"<br /><br />"+content)).data("link","");tab_rename(tab,"Fehler!");tab_update()}}})}else{$.ajax({type:ajaxtype,url:addr,data:post,success:function(data,status,xhr){if(xhr.responseText.substr(0,5)!="<?xml"){var error=xhr.responseText;error=error.replace(/\r\n/g,"");error=error.replace(/\n/g,"");error=error.replace(/<\?xml(.*)$/,"");error="Es ist ein Fehler aufgetreten:<br />Adresse: "+addr+"<br />"+error}else{var error=$(data).find("error").text()}if(error){win_error(type,el,error)}else{var name=$(data).find("name").text();var icon=$(data).find("icon").text();var content=$(data).find("content").text();if(type==4){$("#fenster"+el+" .fhllabel").html(name);$("#fenster"+el+" .fhlfavs").css("display","block");$("#fenster"+el+" .fcc").html(content);$("#fenster"+el).data("link",addr);$("#fenster"+el+" .fcc").scrollTop(0);jQuery.each(fenster,function(){if(this[0]==el){this[1]=icon;this[2]=name}})}else{win_open(icon,name,content,false,addr)}wbar_update();dbhistory_add(addr,name,type);var script=$(data).find("script").text();if(script){eval(script)}}},error:function(e,msg){if(e.status!=0){var content=e.responseText.replace(/<\?xml([.\s]*)$/,"");win_error(type,el,"Es ist ein Fehler aufgetreten!<br /><br />Fehlermeldung: "+msg+" "+e.status+"<br /><br />Adresse: "+addr+"<br /><br />"+content)}}})}}if(tooltip){$("#tooltip").hide();tooltip=false}}function page_create(c,a,d,b){if(c==1){var e=b;if(a==false){$("content"+b).html(tab_headline(a,false)+d)}}else{var e=tab_create(a,d,false)}return e}function page_error(a){return'<div class="icontent" style="text-align:center;margin:20px;font-size:16px;font-weight:bold"><img src="img/layout/error.png" width="150" height="137" alt="Fehler" /><br /><br />'+a+"</div>"}function contentswitch(el,i,loadnew){var addr=$(el).data("link");if(addr==null||addr==""){return false}addr=addajax(addr);if(addr.indexOf("&switch")==-1){addr+="&switch"}var pid=$(el).parents(".content, .fenster").attr("id");var actclick=$("#"+pid+" .icontent"+i).hasClass("icontentact");if(!loadnew&&actclick){return false}$("#"+pid+" .cswact").stop().animate({left:((i-1)*150)+"px"},Math.round(settings.effects*1.75));if($("#"+pid+" .icontent"+i).html().replace(/\s/g,"")==""||loadnew){$("#"+pid+" .icontent"+i).html('<br /><div align="center"><img src="img/layout/ajax2.gif" width="66" height="66" /><br /><br /></div>');$.ajax({type:"get",url:addr,success:function(data,status,xhr){if(xhr.responseText.substr(0,5)!="<?xml"){var error=xhr.responseText;error=error.replace(/\r\n/g,"");error=error.replace(/\n/g,"");error=error.replace(/<\?xml(.*)$/,"");error="Es ist ein Fehler aufgetreten:<br />Adresse: "+addr+"<br />"+error}else{var error=$(data).find("error").text()}if(error){$("#"+pid+" .icontent"+i).html(page_error(error))}else{$("#"+pid+" .icontent"+i).html($(data).find("content").text());var script=$(data).find("script").text();if(script){eval(script)}}},error:function(e,msg){if(e.status!=0){var content=e.responseText.replace(/<\?xml([.\s]*)$/,"");$("#"+pid+" .icontent"+i).html(page_error("Es ist ein Fehler aufgetreten!<br /><br />Fehlermeldung: "+msg+" "+e.status+"<br /><br />Adresse: "+addr+"<br /><br />"+content))}}})}addr=addr.replace(/(&ajax)|(&switch)/g,"");$("#"+pid).data("link",addr);if(!actclick){$("#"+pid+" .icontentact").hide().removeClass("icontentact");$("#"+pid+" .icontent"+i).show().addClass("icontentact")}if(settings.wminoncontent&&pid.search(/fenster/)==-1){win_minall()}if($(el).parents(".content").attr("id")!=null&&addr.indexOf("index.php?")!=-1){if(historyapi){if(document.location.href.replace(/^(.*)\?(.*)(?:|\#(.*))$/,"$2")!=addr.replace(/^index.php\?(.*)$/,"$1")){history.pushState(null,null,addr)}}else{document.location.href=document.location.href.replace(/^(.*)\#(.*)$/,"$1")+"#"+addr.replace(/^index.php\?(.*)$/,"$1")}href=document.location.href}}tabs=[[1,""]];tabcount=1;tabnr=2;acttab=1;function tab_update(){if(!$("#contentbody").length){return false}var a="";if(tabcount>1){jQuery.each(tabs,function(){a+='<div class="tab';if(this[0]==acttab){a+="active"}a+='" id="tab'+this[0]+'"><div class="tableft"></div><div class="tabmiddle"><div class="tabclose" id="tabclose'+this[0]+'" title="Tab schlie&szlig;en"></div>'+this[1]+'</div><div class="tabright"></div></div>'})}$("#tabbar").html(a);jQuery.each(tabs,function(){if(this[0]==acttab){var e=this[1];window.setTimeout(function(){document.title=e+" - ODDB "},20)}});var b=$("#tabbar").height();if(b<30){b=30}$("#contentc").css("top",(b+75)+"px");if(tabcount>1){$(".ctabclose").show()}else{$(".ctabclose").hide()}var d=$("#content"+acttab).data("link");if(d!=null&&d.indexOf("index.php?")!=-1){if(historyapi){if(document.location.href.replace(/^(.*)\?(.*)(?:|\#(.*))$/,"$2")!=d.replace(/^index.php\?(.*)$/,"$1")){history.pushState(null,null,d)}}else{d=d.replace(/(&ajax)|(&switch)/g,"");document.location.href=document.location.href.replace(/^(.*)\#(.*)$/,"$1")+"#"+d.replace(/^index.php\?(.*)$/,"$1");href=document.location.href}var c=d.match(/p=([^&]+)/);if(c!=null){$("#menu > a").removeClass("active");$('#menu > a[data-link="index.php?p='+c[1]+'"]').addClass("active")}}$("#tabbar").sortable({items:".tab, .tabactive",forcePlaceholderSize:true,revert:150,tolerance:"pointer",scroll:false,distance:10,stop:function(){var e=tabs;tabs=[];$("#tabbar").find(".tab, .tabactive").each(function(){var g=$(this).attr("id").replace(/tab/g,"");for(var f=0;f<e.length;f++){if(e[f][0]==g){tabs.push(e[f])}}})}})}function tab_click(a){var a=a.replace(/[^\d]/g,"");if(a==acttab){return false}$("#content"+acttab).hide();$("#content"+a).show();if(settings.wminoncontent){win_minall()}acttab=a;tab_update()}function tab_close(e){if(typeof(e)!="number"){e=e.replace(/[^\d]/g,"")}var d=document.getElementById("content"+e);document.getElementById("contentbody").removeChild(d);var c=0;var a=false;var b=[];jQuery.each(tabs,function(){if(this[0]!=e){b.push([this[0],this[1]]);if(this[0]<e||(this[0]>e&&a)){c=this[0];a=false}}else{a=true}});tabs=b;tabcount--;if(acttab==e){acttab=c;$("#content"+acttab).show()}if(settings.wminoncontent){win_minall()}tab_update()}function tab_close2(a){var b=a.parentNode.parentNode.parentNode.id.replace(/content/g,"");tab_close(b)}function tab_create(a,c,b){var e=tabnr;tabnr++;tabcount++;if(a==false){a="wird geladen..."}if(c==false){c='<br /><div align="center"><img src="img/layout/ajax2.gif" width="66" height="66" /><br /><br /></div>'}else{c=tab_headline(a,b)+c}if(settings.newtabswitch){$("#content"+acttab).hide()}var d=document.createElement("div");d.id="content"+e;d.className="content";if(b==false||b==null){b=""}b=b.replace(/(&ajax)|(&switch)/g,"");d.setAttribute("data-link",b);d.innerHTML=c;if(!settings.newtabswitch){d.style.display="none"}document.getElementById("contentbody").appendChild(d);tabs.push([e,a]);if(settings.newtabswitch){acttab=e}tab_update();if(settings.wminoncontent&&settings.newtabswitch){win_minall()}return e}function tab_headline(b,c){var a='<div class="hl1"><div class="hl1buttons"><div style="background-position:-215px -44px';if(c==false){a+=";display:none"}a+='" title="Seite zu den Favoriten hinzuf&uuml;gen" onclick="fav_add(this, 1)"></div><div  class="favbutton" style="background-position:-240px -44px" title="Seite in einem Fenster &ouml;ffnen" onclick="win_fromcontent2(this, \''+(b.replace(/'/g,"\\'"))+'\', false)"></div><div class="ctabclose" title="Tab schlie&szlig;en" onclick="tab_close2(this)"></div></div>'+b+"</div>";return a}function tab_rename(b,a){jQuery.each(tabs,function(){if(this[0]==b){this[1]=a}})}function tab_fromwin(c){var a=false;jQuery.each(fenster,function(){if(this[0]==c){a=this[2]}});var b=tab_create(a,$("#fenster"+c+" .fcc").html(),$("#fenster"+c).data("link"));$("#content"+b).html('<div class="hl1">'+$("#content"+b+" .hl1").html()+"</div>");$("#fenster"+c+" .fcc > *").clone(true).appendTo("#content"+b);transferform("fenster",c,"content",b);if(settings.closeontransfer){win_close(c)}}function tab_fromwin2(a){var b=a.parentNode.parentNode.parentNode.id.replace(/fenster/g,"");tab_fromwin(b)}function tab_reload(b){var a=$("#content"+b).data("link");if(a==null||a==""){return false}page_load(1,false,a,b,false)}function tab_next(){if(tabs.length<2){return false}var c=false;var b=false;var a=false;jQuery.each(tabs,function(){if(!a){if(c===false){c=this[0]}if(b){tab_click(this[0]+"");a=true}if(this[0]==acttab){b=true}}});if(!a){tab_click(c+"")}}ficon={"":"-300px -54px",system:"-318px -54px",planet:"-336px -54px",player:"-354px -54px",ally:"-372px -54px",meta:"-390px -54px"};fenster=[];fenstercount=0;fensternr=1;actfenster=0;zindex=10;fmove=0;fmovepos=[0,0];fmoveobj=[0,0];function wbar_update(){if(fenster.length){var c=($(window).width()-(fenster.length*3)-160)/fenster.length;if(c>180){c=180}}else{c=180}var b=Math.round((c-35)/7);if(b<3){b=3}var a='<div id="startbutton"></div>';if(fenster.length){a+='<div id="wbarcloseall" title="alle Fenster schlie&szlig;en" onclick="win_closeall()"></div><div id="wbarminall" title="alle Fenster minimieren" onclick="win_minall()"></div>'}jQuery.each(fenster,function(){var d=this[2];if(d.length>b){d=d.substring(0,b-2)+"..."}a+='<div class="barwindow';if(this[0]==actfenster){a+="act"}a+='" style="width:'+c+'px" id="bfenster'+this[0]+'" title="'+this[2]+'"><div style="background-position:'+ficon[this[1]]+'"></div>'+d+"</div>"});$("#windowbar").html(a);$("#windowbar").sortable({items:".barwindow, .barwindowact",forcePlaceholderSize:true,revert:150,tolerance:"pointer",scroll:false,distance:10,stop:function(){var d=fenster;fenster=[];$("#windowbar").find(".barwindow, .barwindowact").each(function(){var f=$(this).attr("id").replace(/bfenster/g,"");for(var e=0;e<d.length;e++){if(d[e][0]==f){fenster.push(d[e])}}})}});if(fenster.length>2){$("#szgr").removeClass("szgr-bottom")}else{$("#szgr").addClass("szgr-bottom")}}function wbar_click(c,b){var e=c.attr("id");var e=e.replace(/[^\d]/g,"");if(actfenster==e&&!b){jQuery.each(fenster,function(){if(this[0]==e){this[3]=0}});win_blendout(e);var d=0;var a=0;jQuery.each(fenster,function(){if(this[4]>d&&this[3]&&this[0]!=e){d=this[4];a=this[0]}});actfenster=a}else{if(actfenster==e&&b){return false}else{if(actfenster==0&&b){return false}else{win_reopen(e,false)}}}wbar_update()}function win_min(a){if(actfenster==a){wbar_click($("#bfenster"+a),0)}else{win_blendout(a);jQuery.each(fenster,function(){if(this[0]==a){this[3]=0}});wbar_update()}}function win_min2(a){var b=a.parentNode.parentNode.parentNode.id.replace(/fenster/g,"");win_min(b)}function win_minall(){jQuery.each(fenster,function(){if(this[3]){win_blendout(this[0]);this[3]=0}});actfenster=0;wbar_update()}function win_blendout(f){var e=$("#fenster"+f).offset();e.top-=$(window).scrollTop();e.left-=$(window).scrollLeft();var a=$("#fenster"+f).width();var b=$("#fenster"+f).height();var c=$("#fenster"+f).css("zIndex");var d=$("#bfenster"+f).offset();d.top-=$(window).scrollTop();$("#fenster"+f).css({zIndex:1000001,minWidth:"0px"}).animate({top:d.top-5,left:d.left,height:0,width:120,opacity:0.2},300,function(){$("#fenster"+f).css({zIndex:c,display:"none",minWidth:"450px",top:e.top,left:e.left,opacity:1,width:a,height:""})})}function win_blendin(f){$("#fenster"+f).css({display:"block",opacity:0});var e=$("#fenster"+f).offset();e.top-=$(window).scrollTop();e.left-=$(window).scrollLeft();var a=$("#fenster"+f).width();var b=$("#fenster"+f).height();var c=$("#fenster"+f).css("zIndex");var d=$("#bfenster"+f).offset();d.top-=$(window).scrollTop();$("#fenster"+f).css({zIndex:1000001,opacity:0.2,minWidth:"0px",top:d.top-5,left:d.left,height:0,width:120}).animate({top:e.top,left:e.left,opacity:1,width:a,height:b},300,function(){$("#fenster"+f).css({zIndex:c,minWidth:"450px",width:a,height:""})})}function win_close(d){$("#fenster"+d).fadeOut(250);window.setTimeout("cdiv2 = document.getElementById('fenster"+d+"');document.body.removeChild(cdiv2);",1000);var c=0;var b=0;var a=[];jQuery.each(fenster,function(){if(this[0]!=d){a.push([this[0],this[1],this[2],this[3],this[4]]);if(this[3]&&this[4]>b){c=this[0];b=this[4]}}});fenster=a;fenstercount--;if(actfenster==d){actfenster=c}wbar_update()}function win_close2(a){var b=a.parentNode.parentNode.parentNode.id.replace(/fenster/g,"");win_close(b)}function win_closeall(){jQuery.each(fenster,function(){win_close(this[0])})}function win_open(h,a,e,b,g){var c=fensternr;fenster.push([fensternr,h,a,1,zindex]);var j='<div class="fhl1" id="fhl'+c+'"><div class="hl1buttons"><div style="background-position:-215px -44px';if(g==false||g==""){j+=";display:none"}j+='" title="Seite zu den Favoriten hinzuf&uuml;gen" onclick="fav_add(this, 2)" class="fhlfavs"></div><div style="background-position:-434px -54px" title="Inhalt in einen neuen DB-Tab laden" onclick="tab_fromwin2(this)"></div><div style="background-position:-408px -54px" title="Fenster minimieren" onclick="win_min2(this)"></div><div style="background-position:-265px -44px" title="Fenster schlie&szlig;en" onclick="win_close2(this)"></div></div><span class="fhllabel">'+a+'</span></div><div class="fcc">'+e+"</div>";var d=document.createElement("div");d.id="fenster"+fensternr;d.className="fenster";d.style.display="none";if(b){d.style.width=b+"px"}d.setAttribute("data-link",g,0);d.style.zIndex=zindex;d.innerHTML=j;document.body.appendChild(d);if(!b){$("#fenster"+fensternr).css({width:($("#fenster"+fensternr).width()+25)+"px"})}$("#fenster"+fensternr).css({maxHeight:($(window).height()-95)+"px"});$("#fenster"+fensternr+" .fcc").css({maxHeight:($(window).height()-145)+"px"});if(!b){var b=$("#fenster"+fensternr).width()}var k=$("#fenster"+fensternr).height();var i=($(window).width()-b)/2;var f=($(window).height()-k-75)/8;if(i<5){i=5}if(f<5){f=5}$("#fenster"+fensternr).css({left:i+"px",top:f+"px"});$("#fenster"+fensternr).fadeIn(250);$("#fenster"+fensternr).resizable({minHeight:150,resize:function(l,m){$("#"+$(l.target).attr("id")+" .fcc").css({height:(m.size.height-50)+"px"})}});actfenster=fensternr;fensternr++;zindex++;wbar_update();return c}function win_reopen(c,b){actfenster=c;var a=false;jQuery.each(fenster,function(){if(this[0]==c){if(this[3]){a=true}this[3]=1;this[4]=zindex}});$("#fenster"+c).css("zIndex",zindex);if(!a){win_blendin(c)}zindex++;if(b){wbar_update()}}function win_fromcontent(e,b,c){var d=fensternr;content=$("#content"+e).html();win_open("",b,content,c,$("#content"+e).data("link"));$("#fenster"+d+" .fcc").html("");$("#content"+e+" > *").clone(true).appendTo("#fenster"+d+" .fcc");$("#fenster"+d+" .hl1").remove();transferform("content",e,"fenster",d);if(settings.closeontransfer&&tabcount>1){var a=false;if(settings.wminoncontent){a=true;settings.wminoncontent=false}tab_close(e);settings.wminoncontent=a}}function win_fromcontent2(c,a,b){var d=c.parentNode.parentNode.parentNode.id.replace(/content/g,"");win_fromcontent(d,a,b)}function win_data(b){for(var a in fenster){if(a>=0&&typeof(fenster[a][0])!="undefined"&&fenster[a][0]==b){return fenster[a]}}return false}function win_reload(b){var a=$("#fenster"+b).data("link");if(a==null||a==""){return false}page_load(4,false,a,b,false)}function win_error(b,a,d){var c=page_error(d);if(b==4){$("#fenster"+a+" .fhllabel").html("Fehler!");$("#fenster"+a+" .fhlfavs").css("display","none");$("#fenster"+a+" .fcc").html(c);jQuery.each(fenster,function(){if(this[0]==a){this[1]="";this[2]="Fehler!"}})}else{win_open("","Fehler!",c,false,"")}wbar_update()}function win_getid(a){var b=$(a).parents(".fenster").attr("id");if(b!=null){b=b.replace(/fenster/g,"");return b}else{return 0}}function parentwin_close(a){var b=$(a).parents(".fenster").attr("id");if(b!=null){b=b.replace(/[^\d]/g,"");win_close(b)}}var szgr=true;function szgr_toggle(){if(szgr){$("#szgr").slideUp("normal");$("#szgrlink").html("Schnellzugriffsleiste &ouml;ffnen")}else{$("#szgr").slideDown("normal");$("#szgrlink").html("Schnellzugriffsleiste schlie&szlig;en")}szgr=!szgr}function szgr_send(a,b){if(b==""){return false}var c="index.php?p=show_"+a+"&id="+encodeURIComponent(b);page_load(settings.szgrtype,false,c,false,false);return false}var startmenu=false;function sm_show(){if(!startmenu){var a="";jQuery.each(dbhistory,function(){if(this[2]==4){this[2]=5}else{if(this[2]==1){this[2]=2}}a+='<a class="fav dbhistorylink" data-link="'+this[0]+'" data-type="'+this[2]+'">'+this[1]+"</a>"});a+='<div id="historyspacer"></div>';$("#historyc").hide().html(a);if(dbhistory.length){$("#historylink").show()}else{$("#historylink").hide()}$("#startmenu").fadeIn(200);window.setTimeout("startmenu = true;",100)}else{sm_hide()}}function sm_hide(){if(startmenu){if(!dbhistory_active){$("#startmenu").fadeOut(200);window.setTimeout("startmenu = false;",100)}else{dbhistory_active=false}}}function sm_updatesize(){var a=$("#startmenuc").height()+25;var b=false;if(window.innerHeight){if(a+38>window.innerHeight){$("#startmenu").css({height:(window.innerHeight-40)+"px",overflow:"",overflowY:"auto"});b=true}}else{if(document.documentElement.clientWidth){if(a+38>document.documentElement.clientHeight){$("#startmenu").css({height:(document.documentElement.clientHeight-40)+"px",overflow:"auto"});b=true}}}if(!b){$("#startmenu").css({height:"",overflow:"hidden"})}}var contextmenu=false;function cm_close(){if(contextmenu){$("#contextmenu").hide()}}function cm_open(q,b,m){var j=0;var n="";if(b==0){var n=m[0];j=m[1]}if(b==1){n="<a href=\"javascript:page_load(2, false, '"+m+"', false, false)\">in neuem DB-Tab öffnen</a><a href=\"javascript:page_load(3, false, '"+m+"', false, false)\">in neuem Browser-Tab öffnen</a>";if($(q.target).parents(".fenster").attr("id")!=null&&settings.winlinknew&&$(q.target).hasClass("winlink")){var l=$(q.target).parents(".fenster").attr("id").replace(/fenster/g,"");n+="<a href=\"javascript:page_load(4, false, '"+m+"', "+l+', false)">im selben DB-Fenster öffnen</a>'}else{n+="<a href=\"javascript:page_load(5, false, '"+m+"', false, false)\">in neuem DB-Fenster öffnen</a>"}if(q.target.className=="fav"){n+="<a href=\"javascript:fav_edit('"+q.target.id+"')\">Favorit bearbeiten</a><a href=\"javascript:void(check=window.confirm('Soll der Favorit wirklich gelöscht werden?'));if(check){fav_del('"+q.target.id+"')}\">aus Favoriten entfernen</a>";j+=5}else{n+="<a href=\"javascript:fav_add('"+m+"', 3)\">zu Favoriten hinzufügen</a>";j+=4}var a=$(q.target);if(a.hasClass("link_planet")&&a.data("id")){n+='<a href="'+ODServer+"/game/index.php?op=orbit&amp;index="+a.data("id")+'" target="_blank">Orbit in OD &ouml;ffnen</a>';n+='<a href="'+ODServer+"/game/index.php?op=fleet&amp;pre_pid_set="+a.data("id")+'" target="_blank">Schiffe hierher schicken</a>';j+=2}else{if(a.hasClass("link_system")&&a.data("id")){n+='<a href="'+ODServer+"/game/index.php?op=system&amp;sys="+a.data("id")+'" target="_blank">System in OD &ouml;ffnen</a>';j+=1}}}else{if(b==2){m=m.replace(/[^\d]/g,"");if(typeof($("#content"+m).data("link"))!="undefined"&&$("#content"+m).data("link")!=""){var d=$("#content"+m).data("link");n='<a href="javascript:fav_add('+m+', 1)">zu Favoriten hinzufügen</a><a href="javascript:tab_reload('+m+')">Tab neu laden</a><a href="javascript:page_load(3, false, \''+d+"', false, false)\">in neuem Browser-Tab öffnen</a>";j+=3}else{n=""}if(typeof($("#content"+m+" .favbutton").attr("onclick"))!="undefined"){var o=$("#content"+m+" .favbutton").attr("onclick");var p=/win_fromcontent2\((.*)\)/;o=p.exec(o);if(o!=null){o=o[0].replace(/win_fromcontent2\(this,/,"win_fromcontent("+m+",");o=o.replace(/"/g,"'");n+='<a href="javascript:'+o+'">in DB-Fenster öffnen</a>';j+=1}}n+="<a href=\"javascript:tab_close('tab"+m+"')\">Tab schließen</a>";j++}else{var d=m[0];var c=m[1];if(typeof($("#fenster"+c).data("link"))!="undefined"&&$("#fenster"+c).data("link")!=""){var d=$("#fenster"+c).data("link");n+='<a href="javascript:fav_add('+c+', 2)">zu Favoriten hinzufügen</a><a href="javascript:win_reload('+c+')">Fenster neu laden</a><a href="javascript:page_load(3, false, \''+d+"', false, false)\">in neuem Browser-Tab öffnen</a>";j+=3}n+='<a href="javascript:tab_fromwin('+c+')">Inhalt in DB-Tab laden</a>';var i=false;var f=win_data(c);if(f){i=f[3]}if(i){n+='<a href="javascript:win_min('+c+')">Fenster minimieren</a>'}else{n+='<a href="javascript:win_reopen('+c+', true)">Fenster &ouml;ffnen</a>'}n+='<a href="javascript:win_close('+c+')">Fenster schließen</a>';j+=3}}$("#contextmenuc").html(n);var k=(j*30)+12;if(q.pageX){var h=q.pageX-$(window).scrollLeft()+10,g=q.pageY-$(window).scrollTop()+5}else{var s=$(q.target),r=s.offset(),h=r.left-$(window).scrollLeft()+s.width()-2,g=r.top-$(window).scrollTop()+s.height()-2}if(g+k>$(window).height()-30){g=g-k}if(h>$(window).width()-220){h-=195}$("#contextmenu").stop().css({display:"none",left:h+"px",top:g+"px",width:"175px",height:"",opacity:"",filter:""});$("#contextmenu").show("fast");contextmenu=true}var tooltip=false;function tt_pos(g){var c=$("#tooltip").height(),d=$("#tooltip").width(),b,h;if(g.type=="touchmousedown"){var f=$(g.target),a=f.offset();b=a.left-20;h=a.top+15;$("#tooltip").css("position","absolute")}else{b=g.pageX-document.documentElement.scrollLeft+10;h=g.pageY-document.documentElement.scrollTop+15;if(navigator.userAgent.indexOf("Chrome")>-1){h-=$("body").scrollTop()}if(h+c>$(window).height()-10){h=h-c-20}if(b+d>$(window).width()-30){b=b-d-30}if(b<0){b=0}if(h<0){h=0}}$("#tooltip").css({left:b+"px",top:h+"px"})}function transferform(f,a,e,d){var b=[];var c=1;$("#"+e+d).find("form").each(function(){b[c]=$(this);c++});var c=1;$("#"+f+a).find("form").each(function(){var g=$(this);var h=b[c];c++;$(this).find("select").each(function(){$(h).find("select[name="+$(this).attr("name")+"]").val($(this).val())});$(this).find("textarea").each(function(){$(h).find("textarea[name="+$(this).attr("name")+"]").val($(this).val())})})}function form_submit(a,b){b=addajax(b);$(a).parents("form").attr("action",b).trigger("onsubmit")}function form_send(f,addr,r){if(addr=="#"){return false}addr=addajax(addr);$("input[type=button], input[type=submit]",f).attr("disabled","disabled");var fdata=$(f).serialize();if(r){$(r).html('<div align="center"><img src="img/layout/ajax.gif" width="24" height="24" /></div>')}$.ajax({type:"post",url:addr,data:fdata,success:function(data,status,xhr){if(xhr.responseText.substr(0,5)!="<?xml"){var error=xhr.responseText;error=error.replace(/\r\n/g,"");error=error.replace(/\n/g,"");error=error.replace(/<\?xml(.*)$/,"");error="Es ist ein Fehler aufgetreten:<br />Adresse: "+addr+"<br />"+error}else{var error=$(data).find("error").text()}if(error){if(r){$(r).html('<div class="error center">'+error+"</div>")}else{alert(error)}}else{if(r){$(r).html($(data).find("content").text())}var script=$(data).find("script").text();if(script){eval(script)}}$("input[type=button], input[type=submit]",f).removeAttr("disabled")},error:function(e,msg){if(e.status!=0){var content=e.responseText.replace(/<\?xml([.\s]*)$/,"");if(r){$(r).html('<span class="error">Es ist ein Fehler aufgetreten!<br />Fehlermeldung: '+msg+" "+e.status+"<br />Adresse: "+addr+"<br /><br />"+content+"</span>")}else{content=content.replace(/<br \/>/g,"\n");content=content.replace(/<(|\/)b>/g,"");alert("Fehler: "+msg+" "+e.status+" "+addr+"\n\n"+content)}}$("input[type=button], input[type=submit]",f).removeAttr("disabled")}});return false}function form_sendget(a,c){$(a).find("input[type=submit]").attr("disabled","disabled");c=addajax(c);c=c+"&"+$(a).find("input").filter(function(d){return(this.value!="")}).serialize()+"&"+$(a).find("select").filter(function(d){return(this.value!="")}).serialize();c=c.replace(/&+$/,"");var b=$(a).parents(".fenster").attr("id");if(b!=null){b=b.replace(/[^\d]/g,"");page_load(4,false,c,b,false)}else{page_load(1,false,c,acttab,false)}return false}function fav_add(c,b){var a="";if(b==1){if(typeof(c)=="number"){var h=c}else{var h=c.parentNode.parentNode.parentNode.id.replace(/content/g,"")}var e=$("#content"+h).data("link");if(e==null||e==""){return false}jQuery.each(tabs,function(){if(this[0]==h){a=this[1].replace(/"/g,"&quot;")}});var g=1}else{if(b==2){if(typeof(c)=="number"){var h=c}else{var h=c.parentNode.parentNode.parentNode.id.replace(/fenster/g,"")}var e=$("#fenster"+h).data("link");if(e==null||e==""){return false}jQuery.each(fenster,function(){if(this[0]==h){a=this[2].replace(/"/g,"&quot;")}});var g=5}else{var e=c;var g=1}}if(e.indexOf("&ajax")!=-1){e=e.replace(/&ajax/g,"")}if(e.indexOf("?ajax")!=-1){e=e.replace(/\?ajax/g,"")}var d='<br /><br /><div align="center"><form action="#" onsubmit="return fav_add2(\''+e+"', this.name.value, this.type.value, "+fensternr+')">Name: <input type="text" class="text" name="name" value="'+a+'" /><br /><br />Standardverhalten: <select name="type" size="1"><option value="1">im aktiven Tab &ouml;ffnen</option><option value="2">in einem neuen DB-Tab &ouml;ffnen</option><option value="3">in einem neuen Browser-Tab &ouml;ffnen</option><option value="5">in einem DB-Fenster &ouml;ffnen</option></select><br /><br /><br /><input type="submit" class="button" value="hinzuf&uuml;gen" /> <input type="button" class="button" value="abbrechen" onclick="win_close('+fensternr+')" /></form></div><br /><br />';var f=win_open("","Zu Favoriten hinzuf&uuml;gen",d,400,"");$("#fenster"+f+" select").val(g);$("#fenster"+f+" input:text").select()}function fav_add2(d,a,c,e){if(a.replace(/\s/g,"")==""){alert("kein Name eingegeben!");return false}var b={link:d,name:a,typ:c};ajaxcall("index.php?p=ajax_general&sp=fav_add",$("#favoriten"),b,false);win_close(e);return false}function fav_del(a){a=a.replace(/fav/,"");ajaxcall("index.php?p=ajax_general&sp=fav_del&id="+a,$("#favoriten"),false,false)}function fav_edit(g){var c=$("#"+g);g=g.replace(/fav/,"");var a=c.html().replace(/"/g,"&quot;");var e=c.data("link");var b=c.data("type");var d='<br /><br /><div align="center"><form action="#" onsubmit="return fav_edit2('+g+", '"+e+"', this.name.value, this.type.value, "+fensternr+')">Name: <input type="text" class="text" name="name" value="'+a+'" /><br /><br />Standardverhalten: <select name="type" size="1"><option value="1">im aktiven Tab &ouml;ffnen</option><option value="2">in einem neuen DB-Tab &ouml;ffnen</option><option value="3">in einem neuen Browser-Tab &ouml;ffnen</option><option value="5">in einem DB-Fenster &ouml;ffnen</option></select><br /><br /><br /><input type="submit" class="button" value="&auml;ndern" /> <input type="button" class="button" value="abbrechen" onclick="win_close('+fensternr+')" /></form></div><br /><br />';var f=win_open("","Favorit bearbeiten",d,400,"");$("#fenster"+f+" select").val(b);$("#fenster"+f+" input:text").select()}function fav_edit2(f,d,a,c,e){if(a.replace(/\s/g,"")==""){alert("kein Name eingegeben!");return false}var b={id:f,link:d,name:a,typ:c};ajaxcall("index.php?p=ajax_general&sp=fav_edit",$("#favoriten"),b,false);win_close(e);return false}var href=document.location.href;function history_check(){if(href!=document.location.href&&document.location.href.indexOf("#")!=-1){href=document.location.href;var b="index.php?"+href.replace(/^(.*)\#(.*)$/,"$2");var a=false;$("#content"+acttab+" .cswlink").each(function(){if(!a&&$(this).data("link")==b){a=true;var c=false;if($(this).data("reload")=="true"){c=true}contentswitch(this,$(this).data("pos"),c)}});if(!a){jQuery.each(tabs,function(){if(!a&&$("#content"+this[0]).data("link")==b){a=true;tab_click("tab"+this[0])}})}if(!a){page_load(1,false,b,acttab,false)}}}function history_checkapi(a){if(a.indexOf("?")==-1){return false}var c="index.php?"+a.replace(/^(.*)\?(.*)(?:|\#(.*))$/,"$2");var b=false;$("#content"+acttab+" .cswlink").each(function(){if(!b&&$(this).data("link")==c){b=true;var d=false;if($(this).data("reload")=="true"){d=true}contentswitch(this,$(this).data("pos"),d)}});if(!b){jQuery.each(tabs,function(){if(!b&&$("#content"+this[0]).data("link")==c){b=true;tab_click("tab"+this[0])}})}if(!b){page_load(1,false,c,acttab,false)}}var dbhistory=[];var dbhistory_active=false;function dbhistory_open(){dbhistory_active=true;$("#historyc").slideDown(250);$("#historylink").slideUp(250);window.setTimeout('sm_updatesize();$("#startmenu").scrollTop(10000);',250)}function dbhistory_add(g,b,e){var f=dbhistory.length;for(var d=0;d<f;d++){if(dbhistory[d][0]==g&&dbhistory[d][1]==b){var c=[];for(var a=0;a<f;a++){if(a!=d){c.push(dbhistory[a])}}dbhistory=c;break}}if(dbhistory.length>=8){dbhistory=dbhistory.slice(dbhistory.length-7)}dbhistory.push([g,b,e])}function quelltext(w,k){k.html("");var d=w.input.value;d=d.replace(/src="/g,'src="file:///');var j=$($.parseHTML(d));var q=j.find("#layout-main");var v={};try{var o=j.find("div.world");if(o.length&&o.html().indexOf(ODWorld)==-1){throw"Falsche OD-Welt!"}if(q.find("td > a[onmouseover*=\"setter('','',' ',' ','')\"]").length){v.typ="sysun";if(j.find(".statusbar a.alliance").length){v.scannerally=j.find(".statusbar a.alliance").attr("href").replace(/[^\d]/g,"")}try{v.id=q.find("#sysid > input").val();v.name=q.find("#sysid").prev("strong").html().replace(/&nbsp;/g,"")}catch(y){throw"Konnte Name und ID nicht ermitteln!"}var x=[];var A;if(q.find('table[width="800"] td[valign="top"] > table').length!=7){throw"Konnte nicht alle Planeten ermitteln!"}q.find('table[width="800"] td[valign="top"] > table').each(function(f){if($(this).find("td").length){x[f]={};try{x[f]["id"]=$(this).find("tr:first-child img").attr("id").replace(/x/,"");x[f]["typ"]=$(this).find("tr:first-child > td").css("background-image").replace(/^.*planet(\d+)_s.*$/,"$1")}catch(p){throw"Konnte ID und Typ nicht ermitteln ("+f+")"}try{A=$(this).find("tr:first-child a").attr("onmouseover");x[f]["name"]=A.replace(/^.*\'<b>(.*)<\/b>:\'\);setter.*$/,"$1");if(A.indexOf("!&lt;/b&gt;&lt;/center&gt;")==-1&&A.indexOf("demateriali")==-1){A=A.replace(/','.*$/,"");A=A.replace(/http:\/\/[a-zA-Z0-9]*\.*omega/g,"");A=A.split("<br>");x[f]["erz"]=A[4].replace(/[^\d+]/g,"");x[f]["wolfram"]=A[5].replace(/[^\d+]/g,"");x[f]["kristall"]=A[6].replace(/[^\d+]/g,"");x[f]["fluor"]=A[7].replace(/[^\d+]/g,"");x[f]["bev"]=A[9].replace(/[^\d+]/g,"");x[f]["groesse"]=A[11].replace(/[^\d+]/g,"");if(x[f]["groesse"]==""||x[f]["groesse"]=="0000"){x[f]["groesse"]=0}}}catch(p){throw"Konnte Planetenwerte nicht ermitteln ("+f+")"}}else{x[f]=""}});v.pl=x}else{if(q.find("font#sysid > input").length){v.typ="system";try{v.id=q.find("#sysid > input").val();v.name=q.find("#sysid").prev("strong").html().replace(/&nbsp;/g,"")}catch(y){throw"Konnte Name und ID nicht ermitteln!"}var x=[];var A,m;if(q.find('table[width="800"] td[valign="top"] > table').length!=7){throw"Konnte nicht alle Planeten ermitteln!"}q.find('table[width="800"] td[valign="top"] > table').each(function(p){if($(this).find("td").length){x[p]={};try{x[p]["id"]=$(this).find("tr:first-child img").attr("id").replace(/x/,"");x[p]["typ"]=$(this).find("tr:first-child > td").css("background-image").replace(/^.*planet(\d+)_s.*$/,"$1")}catch(r){throw"Konnte ID und Typ nicht ermitteln ("+p+")"}try{A=$(this).find("tr:first-child a").attr("onmouseover");x[p]["name"]=A.match(/\'([^\']*):\'\);setter\(/)[1];A=A.replace(/','.*$/,"");A=A.split("<br>");if(A.length==6){x[p]["groesse"]=0;x[p]["bev"]=0}else{x[p]["bev"]=A[4].replace(/[^\d+]/g,"");var f=A[6].match(/e: (\d+)\',/);if(f){x[p]["groesse"]=f[1]}else{throw"Konnte Größe nicht ermitteln ("+p+")"}}A=$(A[3]);x[p]["erz"]=A.find("tr:nth-child(2) > td:nth-child(2)").html().replace(/[^\d+]/g,"");x[p]["wolfram"]=A.find("tr:nth-child(4) > td:nth-child(2)").html().replace(/[^\d+]/g,"");x[p]["kristall"]=A.find("tr:nth-child(5) > td:nth-child(2)").html().replace(/[^\d+]/g,"");x[p]["fluor"]=A.find("tr:nth-child(6) > td:nth-child(2)").html().replace(/[^\d+]/g,"")}catch(r){throw"Konnte Planetenwerte nicht ermitteln ("+p+")"+r}m=/setter\(\'(.+)\',[\r\n\s]*\'(\d+)\',\'.*\',\'(.*)\',\'(.*)\'\);/;A=m.exec($(this).find("tr:first-child a").attr("onmouseover"));if(A==null){throw"Konnte Inhaber nicht ermitteln! ("+p+")"}else{x[p]["inhaber"]=A[2];x[p]["allianz"]=A[3];if(A[2]==0){if(A[1].indexOf("Lux")!=-1){x[p]["inhaber"]=-2}else{if(A[1].indexOf("Altrasse")!=-1){x[p]["inhaber"]=-3}}}}if($(this).find('tr:last-child img[src*="tor.gif"]').length){x[p]["gate"]=1}m=/<b>(?:Absprungpunkt nach|Jump-off point to) .*<\/b>(?:\s*)\((\d+)\)\'/;A=m.exec($(this).find("tr:last-child a").attr("onmouseover"));if(A!=null){x[p]["mgate"]=A[1]}m=/<b> Zielpunkt von (?:.+)<\/b>(?:\s*)\((\d+)\)\'/;A=m.exec($(this).find("tr:last-child a").attr("onmouseover"));if(A!=null){x[p]["riss"]=A[1]}if($(this).find('tr:last-child img[src*="flotte-bergbau.gif"]').length){x[p]["bb"]=1}else{if($(this).find('tr:last-child img[src*="flotte_natives.gif"]').length){x[p]["natives"]=1}else{if($(this).find('tr:last-child img[src*="flotte-kolo.gif"]').length){x[p]["kolo"]=1}else{if($(this).find('tr:last-child img[src*="flotte-genesis.gif"]').length){x[p]["genesis"]=1}else{if($(this).find('tr:last-child img[src*="flotte_terraform.gif"]').length){x[p]["tf"]=1}else{if($(this).find('tr:last-child img[src*="flotte_invasion.gif"]').length){x[p]["inva"]=1}else{if($(this).find('tr:last-child img[src*="flotte-besatzer.gif"]').length){x[p]["besatzung"]=1}else{if($(this).find('tr:last-child img[src*="orbit_blank.gif"]').length){x[p]["leer"]=1}}}}}}}}}else{x[p]=""}});v.pl=x}else{if(q.find("tr.bewtr").length&&q.find('a[href^="?op=orbit"]').length){v.typ="planet";var A;var m;v.id=q.find('a[href^="?op=orbit"]').attr("href").replace(/[^\d]/g,"");var D=q.find('a[href^="?op=renamer"]').html();if(D==null){D=q.find("table table tr:first-child > td:last-child > b").html();if(D==null){throw"Konnte Name nicht ermitteln!"}}v.name=D;try{v.pltyp=q.find('td[width="600"][background]').attr("background").replace(/^.*planet(\d+)\..*$/,"$1")}catch(y){throw"Konnte Planetentyp nicht ermitteln!"}try{var A=q.find('a[href^="?op=orbit"]').parents("tr").next().find("b");if(A){v.inhabername=A.html()}}catch(y){}A=q.find('img[src*="icon_planet_info.gif"]').parent().attr("onmouseover");if(A==null){throw"Konnte Planetenwerte nicht ermitteln!"}A=A.replace(/','.*$/,"");A=A.split("<br>");v.erz=A[1].replace(/[^\d]/g,"");v.wolfram=A[3].replace(/[^\d]/g,"");v.kristall=A[4].replace(/[^\d]/g,"");v.fluor=A[5].replace(/[^\d]/g,"");v.bev=A[7].replace(/[^\d]/g,"");v.groesse=A[8].replace(/[^\d]/g,"");v.bevakt=v.bev*(50-q.find('.bewtr > td[bgcolor="#BBBBBB"]').length)/50;try{if(q.find("#erzproduktion > font").length){v.erzp=q.find("#erzproduktion > font").html().replace(/[^\-\d]/g,"")}else{v.erzp=q.find("#erzproduktion").html().replace(/[^\-\d]/g,"")}v.metallp=q.find("#metallproduktion").html().replace(/[^\d]/g,"");v.wolframp=q.find("#wolframproduktion").html().replace(/[^\d]/g,"");v.kristallp=q.find("#kristallproduktion").html().replace(/[^\d]/g,"");v.fluorp=q.find("#flourproduktion").html().replace(/[^\d]/g,"");v.erzm=q.find("#erzdais").html().replace(/[^\d]/g,"");v.metallm=q.find("#metallda").html().replace(/[^\d]/g,"");v.wolframm=q.find("#wolframda").html().replace(/[^\d]/g,"");v.kristallm=q.find("#kristallda").html().replace(/[^\d]/g,"");v.fluorm=q.find("#flourda").html().replace(/[^\d]/g,"")}catch(y){throw"Konnte Ressproduktion und -vorrat nicht ermitteln!"}try{v.forschung=q.find("#forprod").parent().parent().prev().find("b").html().replace(/[^\d]/g,"");v.industrie=q.find("#indprod").parent().parent().prev().find("b").html().replace(/[^\d]/g,"")}catch(y){throw"Konnte Forschung und Industrie nicht ermitteln!"}try{A=q.find('td[width="600"][background]');for(var u=1;u<=36;u++){v["g"+u]=A.find('img[name="pod'+u+'"]').attr("src").replace(/^.*\/img\/(?:buildings\/|misc\/)*/,"").replace(/blank.gif/,"")}A=A.prev();for(u=1;u<=12;u++){v["o"+u]=A.find('img[name="wpod'+u+'"]').attr("src").replace(/^.*\/img\/(?:buildings\/|misc\/)*/,"")}}catch(y){throw"Konnte Gebäude nicht ermitteln!"}try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}if(q.find("#creditsda").html()!=""){try{v.konto=q.find("#creditsda").html().replace(/[^\d\-]/g,"");v.steuer=q.find('img[src*="credits_small.gif"]').last().next().children("b").html().replace(/^(\S*) .*$/,"$1").replace(/[^\d]/g,"");A=q.find('img[src*="research_small.gif"]').next().children("b").html();if(A.indexOf("+")!=-1){A=A.split("+");A[0]=A[0].replace(/[^\d]/g,"");A[1]=A[1].replace(/[^\d]/g,"");v.fpges=parseInt(A[0])+parseInt(A[1])}else{v.fpges=A.replace(/[^\d]/g,"")}}catch(y){throw"Konnte Einnahmen und Gesamtforschung nicht ermitteln!"+y}}if(q.find('table[width="821"] td:last-child img[src*="ships"]').length){v.schiff=q.find('input[name="bauzeit"]').val()}}else{if(q.find('a[href="?op=planlist&order=name"]').length){v.typ="poview";if(!q.find("tr[pname]").first().is("tr[pname][pslots][perz][pwolfram][pkristall][pflour][pverz][pvmetall][pvwolfram][pvkristall][pvflour][pgrafik]")){throw"Planetenübersicht invalid!"}try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Inhaber nicht ermitteln!"}v.pl=[];var b;var x;var c;var a;q.find("tr[pname]").each(function(f){x={};try{x.id=$(this).find('a[href^="?op=planet&index"]').attr("href").replace(/[^\d]/g,"");x.sid=$(this).find('a[href^="?op=system&sys"]').attr("href").replace(/[^\d]/g,"");x.name=$(this).attr("pname");x.gr=$(this).attr("pslots");x.rw=[$(this).attr("perz"),$(this).attr("pwolfram"),$(this).attr("pkristall"),$(this).attr("pflour")].join("X");x.rv=[$(this).attr("pverz").replace(/[^\d]/g,""),$(this).attr("pvmetall").replace(/[^\d]/g,""),$(this).attr("pvwolfram").replace(/[^\d]/g,""),$(this).attr("pvkristall").replace(/[^\d]/g,""),$(this).attr("pvflour").replace(/[^\d]/g,"")].join("X");x.scr=$(this).attr("pgrafik");x.scr=x.scr.replace(/^.*planet(\d*)_s\.jpg/,"typ=$1");x.scr=x.scr.replace(/&s/g,"X");x.scr=x.scr.replace(/=/g,"Y");if($(this).find('img[src*="ships"]').length){x.schiff=$(this).find("td[remtimea]").attr("remtimea")}if($(this).children("td:last-child").html()!=""){x.inva=$(this).children("td:last-child").html();x.inva=x.inva.replace(/(<strong>|<\/strong>|<font color="#[0F]+">|<\/font>)/g,"")}}catch(i){throw"Fehler beim Einscannen der Planetenübersicht!"}v.pl.push(x)})}else{if(q.find("#jumpGateDialog").length){v.typ="orbit";var A;try{v.id=q.find('a[href*="&typ=e"]').attr("href").replace(/^.*=(\d+)&typ.*$/,"$1")}catch(y){throw"Konnte ID nicht ermittel!"}try{if(q.find('form[name="gotoplan"] a[href*="op=usershow"]').length){v.inhaber=q.find('form[name="gotoplan"] a[href*="op=usershow"]').attr("href").replace(/^.*welch=(\d+)$/,"$1")}else{A=q.find('form[name="gotoplan"] tr:first-child font').html();if(A.indexOf("Altrasse")!=-1){v.inhaber=-3}else{if(A.indexOf("Lux")!=-1){v.inhaber=-2}else{v.inhaber=0}}}}catch(y){throw"Konnte Inhaber nicht ermitteln!"}v.frs=q.find('a[href*="typ=f"]').parent().clone().children("a").remove().end().html();if(d==false){var d=q.html()}if(d.indexOf("sich gerade einen Urlaub. Der Planet ist nicht einnehmbar!")!=-1||d.indexOf("treating himself a holiday")!=-1){v.umod=1}if(d.indexOf("<b>Dieser Planet ist gerade besetzt!")!=-1||d.indexOf("<b>Dieser Planet wird gerade besetzt!")!=-1||d.indexOf("<b>This planet is occupied at present!")!=-1){v.bes=1;A=q.find('img[src*="warn.gif"]').parent().next().find('a[href*="usershow"]');if(A.length){v.besuser=A.attr("href").replace(/[^\d]/g,"")}}var m=/(?:bernahmezeitpunkt|Completion date): (?:.{3}), ([^<]+)<br/;if(d.indexOf("<b>Dieser Planet wird gerade kolonisiert.")!=-1||d.indexOf("<b>This planet is currently being colonised")!=-1){v.kolo=1;A=m.exec(d);if(A==null){throw"Konnte Kolodaten nicht ermitteln!"}v.koloende=A[1];A=q.find('div[name="alldiv"] a[href*="usershow"]');if(A.length){v.kolouser=A.attr("href").replace(/[^\d]/g,"")}}if(d.indexOf("<b>Dieser Planet wird gerade invadiert!")!=-1||d.indexOf("<b>This planet is currently being invaded")!=-1){v.inv=1;A=m.exec(d);if(A==null){throw"Konnte Invadaten nicht ermitteln!"}v.invende=A[1];A=q.find('div[name="alldiv"] a[href*="usershow"]');if(A.length){v.invauser=A.attr("href").replace(/[^\d]/g,"")}}if(d.indexOf("An diesem Planeten wird ein Genesis-Projekt gestartet.")!=-1||d.indexOf("At this planet a genesis project is initiated.")!=-1){v.gen=1;m=/(?:ndung|Firing): (?:.{3}), ([^<]+)<br/;A=m.exec(d);if(A==null){throw"Konnte Genesis-Daten nicht ermitteln!"}v.genende=A[1];var l=q.find('.box td:contains("enesis") a[href^="?op=usershow"]');if(l.length){v.genuser=l.attr("href").replace(/[^\d]/g,"")}}if(d.indexOf("sich gerade ein Resonator auf, um diesen Planeten und alle Schiffe im Orbit zu vernichten!")!=-1||d.indexOf("<b>A resonator is currently charging up so that it can destroy this planet and all ships in orbit around it")!=-1||d.indexOf("sich gerade ein Schiff auf, um diesen Planeten zu vernichten!")!=-1){v.reso=1;m=/(?:ndung|Firing): (?:.{3}), ([^<]+)</;A=m.exec(d);if(A==null){throw"Konnte Reso-Daten nicht ermitteln!"}v.resoende=A[1]}if(d.indexOf(">Achtung - In diesem Orbit stehen sehr starke Schiffe!")!=-1){v.natives=1}if(d.indexOf("><b>Sprunggenerator aktiv</b></font>")!=-1){v.sprung=1}if(d.indexOf(">An diesem Planeten läuft ein Bergbauvorgang.<")!=-1||d.indexOf(">An diesem Planeten l&auml;uft ein Bergbauvorgang.<")!=-1||d.indexOf(">A mining operation is active.<")!=-1){v.bb=1}if(d.indexOf(">Dieser Planet wird mittels Terraforming verbessert.<")!=-1){v.tf=1}}else{if(q.find('form[action="?op=settings"]').length){v.typ="einst";try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}v.einst="0";v.einst+=q.find("#pn2:checked").length;v.einst+=q.find("#pv2:checked").length;v.einst+=q.find("#nap2:checked").length;if(q.find("#km1:checked").length){v.einst+="1"}else{if(q.find("#km2:checked").length){v.einst+="2"}else{v.einst+="3"}}if(q.find("#sm1:checked").length){v.einst+="1"}else{if(q.find("#sm2:checked").length){v.einst+="2"}else{v.einst+="3"}}}else{if(q.find('a.active[href*="tab=5"]').length){v.typ="floview";try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}var A=$(q.children(".box")[5]).find("b");v.steuer=$(A[2]).html().replace(/[^\d+]/g,"");var C=q.find("tr.quickjump:has(b)"),z=C.find("td:last-child"),g=C.next().find("td:last-child"),B=q.find("tr.tablecolor + tr:not(.tablecolor)").find("td:eq(1)");if(C.length!=2){throw"Konnte Kommandopunkte nicht ermitteln!"}try{v.pkop=z.first().html().replace(/[^\d+]/g,"");v.kop=z.last().html().replace(/[^\d+]/g,"");v.pkopmax=g.first().html().replace(/[^\d+]/g,"");v.kopmax=g.last().html().replace(/[^\d+]/g,"")}catch(y){throw"Fehler beim Ermitteln der Kommandopunkte!"}try{v.schiffe=parseInt(B.eq(0).html().replace(/[^\d+]/g,""))+parseInt(B.eq(1).html().replace(/[^\d+]/g,""))}catch(y){throw"Konnte Anzahl der Schiffe nicht ermitteln!"}}else{if(q.find('a.active[href*="tab=2"]').length){v.typ="floviewbbs";try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}v.bb=[];try{q.find(".tabletrans td:nth-child(6) > a[href*=orbit]:first-child").each(function(){v.bb.push($(this).attr("href").replace(/[^\d]/g,""))})}catch(y){throw"Fehler beim Erfassen der Bergbauschiffe!"}v.bb=v.bb.join("-")}else{if(q.find('a[href="?op=sitter&was=auftraege"]').length){v.typ="sitter";try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}var s=[];q.find('a[href*="sitter&umloggen"]').each(function(){s.push($.trim($(this).clone().children("font").remove().end().html()))});v.sitterfrom=s;var t=[];q.find("td:last-child > .box td[width]:first-child").each(function(){t.push($.trim($(this).clone().children("font").remove().end().html()))});v.sitterto=t}else{if(q.find('a[href="?op=tech&tree=geb"]').length&&q.find('img[src*="basiscamp.gif"], img[src*="titanid_s.gif"], img[src*="ion1.gif"]').length){v.typ="forschung";try{v.uid=j.find("div.statusbar a.user").attr("href").replace(/^.*=(\d+)$/,"$1")}catch(y){throw"Konnte Spieler nicht ermitteln!"}v.f=[];v.fn=[];v.ff=[];v.kategorie=0;var h={1:"basiscamp.gif",2:"titanid_s.gif",3:"ion1.gif"};q.find("img[titel]").each(function(){var p=$(this),f=p.attr("src");if(f.indexOf("/static/img/")==-1){throw"Grafikpfade ungültig!"}if(v.kategorie==0){for(var e in h){if(f.indexOf(h[e])!=-1){v.kategorie=e;break}}}v.f.push(f.replace(/^.*\/img\//,""));v.fn.push(p.attr("titel"));v.ff.push(p.hasClass("opacity2")?1:0)});if(!v.f.length){throw"Konnte Forschungen nicht ermitteln!"}var n=q.find(".tabletranslight .box td:first-child img");if(n.length){v.current=n.attr("src").replace(/^.*\/img\//,"");v.current_end=q.find("#returntim").siblings("b").html()}}else{k.append("Quelltext unbekannt!");return false}}}}}}}}}}}catch(y){k.append(y);return false}w.input.value="";ajaxcall("index.php?p=scan&sp=scan&force",k,v,true)}function quelltext_mainscreen(j,a){var l=j.input.value;a.html("");var g={};if(typeof(j.elements.repair)!="undefined"&&j.elements.repair.checked==true){g.repair=1}l=l.replace(/<\/html>(.*)$/,"</html>");l=l.replace(/\std width=/g,"<td width=");var m=$($.parseHTML(l)),h=m.find("#layout-main"),b=h.find("a[href*='op=main&order=id&first=0&last=5000&galax=']");if(b.length){try{g.gala=b.attr("href").replace(/^.+&galax=/,"");var d=b.parent().html().match(/^[a-zA-Z\s]+:\s*(\d+)\s*</)[1];var i=[];var c=h.find(".tabletrans-fleet, .tabletranslight-fleet");if($(c[0]).children().length!=7||$(c[0]).find("a").length!=1){throw"Mainscreen-Quelltext ungültig!"}if(c.length!=d){a.html('<div class="error">Der Mainscreen ist nicht vollst&auml;ndig!</div>');return false}c.each(function(){var n=$(this),e=n.children(),f=[];i.push([n.find("a").attr("href").replace(/^.+&sys=(\d+)&.+$/,"$1"),n.find("a").text(),e.eq(3).text(),e.eq(4).text(),e.eq(5).text()])});g.s=i}catch(k){alert(k);return false}}else{a.html('<div class="error">unbekannter Quelltext!</div>');return false}j.input.value="";g={data:$.param(g)};ajaxcall("index.php?p=admin&sp=galaxien_parse",a,g,true)}function kommentar_edit(e,c,d){var a="";var b="hinzuf&uuml;gen";if(d){a=$(c).find(".kommentarc").html();a=a.replace(/<br \/>(?:\n*)/gi,"\n");a=a.replace(/<br>(?:\n*)/gi,"\n");if(d){b="bearbeiten"}}$(c).html('<form action="#" onsubmit="return form_send(this, \'index.php?p=show_planet&id='+e+'&sp=kommentar&ajax\', $(this.parentNode))"><div class="kommentar" style="float:left"></div> &nbsp; &nbsp; Kommentar '+b+'<div style="width:80%;text-align:center;margin-top:5px"><textarea name="kommentar" style="width:100%;height:40px">'+a+'</textarea><br /><input type="submit" class="button" style="margin-top:3px" value="abschicken" /></div></form>');$(c).find("textarea").select()}function openinvas(){var a="index.php?p=ajax_general&sp=openinvas&ajax";$.ajax({type:"get",url:a,success:function(c){var b=$(c).find("content").text();openinvas_update(b)},error:function(c,d){if(c.status!=0){var b=c.responseText.replace(/<\?xml([.\s]*)$/,"");b=b.replace(/<br \/>/g,"\n");b=b.replace(/<(|\/)b>/g,"");alert("Es ist ein Fehler aufgetreten!\n\nFehlermeldung: "+d+" "+c.status+"\n\nAdresse: "+a+"\n\n"+b)}}})}function openinvas_update(b){var a=b+" offene Aktion";if(b!=1){a+="en"}a+="!";$("#headerinva a").html(a);if(b>0){$("#headerinva").show(200)}else{$("#headerinva").hide(200)}}function invakommentar_edit(e,c,d){var a="";var b="hinzuf&uuml;gen";if(d){a=$(c).find(".kommentarc").html();a=a.replace(/<br \/>(?:\n*)/gi,"\n");a=a.replace(/<br>(?:\n*)/gi,"\n");if(d){b="bearbeiten"}}$(c).html('<form action="#" onsubmit="return form_send(this, \'index.php?p=inva&sp=inva_kommentar&id='+e+'&ajax\', $(this.parentNode))"><div class="kommentar" style="float:left"></div> &nbsp; &nbsp; Kommentar '+b+'<div style="width:80%;text-align:center;margin-top:5px"><textarea name="kommentar" style="width:100%;height:40px">'+a+'</textarea><br /><input type="submit" class="button" style="margin-top:3px" value="abschicken" /></div></form>');$(c).find("textarea").select()}function searchnav(h,c,b){var f=$("#snav"+c).val();var e=c+"-"+h+"-"+b;if(f==null){$("#snavbox"+e).slideUp(200)}else{var f=f.split("-");var g=-1;for(var a in f){if(f[a]==h){g=parseInt(a)}}if(g==-1){$("#snavbox"+e).slideUp(200)}else{if(f.length<2){$("#snavbox"+e).hide()}else{var d='<table border="0" style="width:100%"><tr><td style="width:35%;text-align:left;font-weight:bold">';if(g>0){d+='<a class="link contextmenu" link="index.php?p=show_planet&id='+f[g-1]+"&nav="+c+'">&laquo; vorheriger Planet ('+f[g-1]+")</a>"}d+='</td><td style="width:30%;text-align:center">Planeten-Navigation</td><td style="width:35%;text-align:right;font-weight:bold">';if(g<f.length-1){d+='<a class="link contextmenu" link="index.php?p=show_planet&id='+f[g+1]+"&nav="+c+'">n&auml;chster Planet ('+f[g+1]+") &raquo;</a>"}d+="</td></tr></table>";$("#snavbox"+e).html(d)}}}}function systemnav(h,c,b){var f=$("#sysnav"+c).val();var e=c+"-"+h+"-"+b;if(f==null){$("#sysnavbox"+e).slideUp(200)}else{var f=f.split("-");var g=-1;for(var a in f){if(f[a]==h){g=parseInt(a)}}if(g==-1){$("#sysnavbox"+e).slideUp(200)}else{if(f.length<2){$("#sysnavbox"+e).hide()}else{var d='<table border="0" style="width:100%"><tr><td style="width:35%;text-align:left;font-weight:bold">';if(g>0){d+='<a class="link contextmenu" link="index.php?p=show_system&id='+f[g-1]+"&nav="+c+'">&laquo; vorheriges System ('+f[g-1]+")</a>"}d+='</td><td style="width:30%;text-align:center">System-Navigation</td><td style="width:35%;text-align:right;font-weight:bold">';if(g<f.length-1){d+='<a class="link contextmenu" link="index.php?p=show_system&id='+f[g+1]+"&nav="+c+'">n&auml;chstes System ('+f[g+1]+") &raquo;</a>"}d+="</td></tr></table>";$("#sysnavbox"+e).html(d)}}}}function rechte_click(a){var b=$(a).val();var c=$(a.parentNode).siblings("td:last-child");if(b==-1){$(c).css("color","#ffffff");if($(c).hasClass("rechtedisabled")){$(c).css("opacity","0.4")}}else{$(c).css("opacity","1");if(b==1){$(c).css("color","#00aa00")}else{$(c).css("color","#ff3322")}}}function allianz_status(d,a){var b='<tr class="allianzrow'+d+'"';if($(".allianzrow"+d).css("opacity")=="0.4"){b+=' style="opacity:0.4"'}b+=">"+$(".allianzrow"+d).html()+"</tr>";$(".allianzrow"+d).remove();$(".allianzstatus"+a).append(b);$(".allianzstatus"+a+" .allianzenkeine").remove();$(".allianzrow"+d+" select").val(a)}function allianz_filter(a,c){c=c.replace(/&/g,"&amp;");c=c.replace(/"/g,"&quot;");c=c.replace(/</g,"&lt;");c=c.replace(/>/g,"&gt;");c=c.replace(/\\/g,"\\\\");c=c.replace(/\(/g,"\\(");c=c.replace(/\)/g,"\\)");c=c.replace(/\[/g,"\\[");c=c.replace(/\]/g,"\\]");var b=new RegExp(c,"i");$(a).find("tr").each(function(){if(this.className!="allianzenheadline"&&this.className!="allianzenkeine"){var e=$(this).find("td:nth-child(2) a").html();var d=$(this).find("td:nth-child(3) a").html();if(c==""||e.search(b)!=-1||d.search(b)!=-1){$(this).show()}else{$(this).hide()}}})}function mgate_filter(a,b){if(b==""){$(a).find(".filter").show()}else{$(a).find(".filter[name!=gala"+b+"]").hide();$(a).find(".filter[name=gala"+b+"]").show()}}function scout_weiter(c,a){var b=$(a).parents(".icontent").find("form");$(b).find("input[name=start]").val(c);b.trigger("onsubmit")}function route_marker(a){if($(a).parents("tr").hasClass("trhighlight")){$(a).parents("tr").removeClass("trhighlight");ajaxcall("index.php?p=route&sp=setmarker&id="+$(a).parents("table").attr("name")+"&marker=0&ajax",false,false,false)}else{$(a).parents("table").find("tr").removeClass("trhighlight");$(a).parents("tr").addClass("trhighlight");ajaxcall("index.php?p=route&sp=setmarker&id="+$(a).parents("table").attr("name")+"&marker="+$(a).parents("td").attr("name")+"&ajax",false,false,false)}}var werftPage={setBedarf:function(e){var d=$(e),f=d.val().split("-"),b=d.parent().find("form"),a=["erz","metall","wolfram","kristall","fluor"];if(f.length!=5){return}for(var c in a){b.find('input[name="'+a[c]+'"]').val(f[c])}}};var settingsPage={addFoWSearch:function(a){a.data("max",a.data("max")+1);var b=a.data("timestamp")+a.data("max");a.append('<div id="'+b+'"><div class="closebutton" title="Eintrag l&ouml;schen" onclick="$(this.parentNode).remove()"></div><div class="fowsearch1">Name: <input type="text" class="text" name="sname[]" value="" /><br />die <input type="text" class="text smalltext" style="width:30px" name="scount[]" value="1" /> <select name="sorder[]" size="1"><option value="0">n&auml;chsten</option><option value="1">entferntesten</option></select> Treffer<br /><select name="sout[]"><option value="1">nur au&szlig;erhalb des Systems</option><option value="0">alle Planeten finden</option></select></div><div class="fowsearch3"><a onclick="page_load(5, \'FoW-Suchfilter konfigurieren\', \'index.php?p=settings&amp;sp=fow_editsearch&amp;target='+b+'\', false, {filter : $(this.parentNode.parentNode).find(\'input[type=hidden]\').val()})"><img src="img/layout/leer.gif" class="icon hoverbutton configbutton" title="konfigurieren" /> </a></div><div class="fowsearch2"><a onclick="page_load(5, \'FoW-Suchfilter konfigurieren\', \'index.php?p=settings&amp;sp=fow_editsearch&amp;target='+b+'\', false, {filter : $(this.parentNode.parentNode).find(\'input[type=hidden]\').val()})"><img src="img/layout/leer.gif" class="icon hoverbutton configbutton" title="konfigurieren" /> <i>noch nicht konfiguriert</i></a></div><input type="hidden" name="sval[]" value="" /></div>')},editFoWSearch:function(b,c){var d=$(b).find("input").filter(function(e){return(this.value!="")}).serialize(),a=$(b).find("select").filter(function(e){return(this.value!="")}).serialize();if(a!=""){d+="&"+a}$("#"+c+" input[type=hidden]").val(d);ajaxcall("index.php?p=settings&sp=fow_searchdesc",$("#"+c+" .fowsearch2"),{filter:d},true);parentwin_close(b);return false}};var toolsPage={changeApiKey:function(){if(window.confirm("Möchtest du deinen API-Key wirklich ändern?")){ajaxcall("index.php?p=tools&sp=apikey",false,false,false)}}};var forschungPage={filter:function(d){var e=$(d).parents(".forschung_container"),a=e.find(".icon_forschung_filter_active"),b=e.find("tr:gt(0)"),c=[];a.each(function(){c.push($(this).data("forschung"))});b.removeClass("forschung_hidden");b.each(function(){var g=$(this);for(var f in c){if(!g.find('img[data-forschung="'+c[f]+'"]').length){g.addClass("forschung_hidden");return}}})}};var contextmenuTriggered=false;(function(){var a=false,b=false,c=false;$(document).on("touchstart",function(d){c=d.target;a=window.setTimeout(function(){$(c).trigger("touchmousedown");a=false},200);b=window.setTimeout(function(){b=false;contextmenuTriggered=true;$(c).trigger("touchcontextmenu")},600)}).on("touchmove",function(){if(a){window.clearTimeout(a);a=false}if(b){window.clearTimeout(b);b=false}}).on("touchend",function(d){if(b){window.clearTimeout(b);b=false}if(contextmenuTriggered){window.setTimeout(function(){contextmenuTriggered=false},400)}})})();